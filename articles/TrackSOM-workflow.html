<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>TrackSOM-workflow • TrackSOM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="TrackSOM-workflow">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TrackSOM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/TrackSOM-workflow.html">TrackSOM-workflow</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>TrackSOM-workflow</h1>
                        <h4 data-toc-skip class="author">Givanna
Putri</h4>
            
      

      <div class="d-none name"><code>TrackSOM-workflow.Rmd</code></div>
    </div>

    
    
<p>In this tutorial, we outline a step by step instruction on how to use
TrackSOM to cluster and track time-series data. For simplicity, we will
use the synthetic dataset outlined in our manuscript uploaded to <a href="https://www.biorxiv.org/content/10.1101/2021.06.08.447468v1" class="external-link">bioArxiv</a>.
The dataset files are provided in the <code>inst</code> directory: <a href="https://github.com/ghar1821/TrackSOM/tree/master/inst/extdata" class="external-link">link</a>.</p>
<div class="section level2">
<h2 id="importing-tracksom-package">Importing TrackSOM package<a class="anchor" aria-label="anchor" href="#importing-tracksom-package"></a>
</h2>
<p>If you have not installed the TrackSOM package, please use
<code>devtools</code> to install the package from the following <a href="https://github.com/ghar1821/TrackSOM" class="external-link">TrackSOM github repo</a>.
For devtools, the repo parameter will be:
<code>ghar1821/TrackSOM</code>.</p>
<p>The following code shall import the TrackSOM package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ghar1821.github.io/TrackSOM/">TrackSOM</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="importing-dataset">Importing dataset<a class="anchor" aria-label="anchor" href="#importing-dataset"></a>
</h2>
<p>TrackSOM supports dataset stored as either CSV or FCS files or as
<code>data.table</code> object (enhanced version of R’s native
data.frame. See <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html" class="external-link">data.table
vignette</a> for more details). The following sections shall show you
how to read in those files and pass them to the TrackSOM function.</p>
<div class="section level3">
<h3 id="dataset-as-csv-files">Dataset as CSV files<a class="anchor" aria-label="anchor" href="#dataset-as-csv-files"></a>
</h3>
<p>Here, we assume that each file contains data belonging to one
time-point. Hence you should have more than 1 CSV files. If this is not
the case, please reformat your data files.</p>
<p>To import the dataset stored as CSV files, TrackSOM needs to know
where the files are stored. These files’ location must be stored within
a vector which get passed on to the TrackSOM function.</p>
<p><em>Important:</em> the vector must be organised such as the first
element is the data for the very first time-point, the 2nd element for
the 2nd time-point, and so on.</p>
<p>First, we start with specifying the CSV files are. In this example,
the dataset files are already stored within the package, so all you need
to do is load it up:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data.files.fullpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d0.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d1.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d2.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d3.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d4.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><em>For your dataset, please replace the content of the vector with
the <strong>absolute path</strong> for the dataset files!</em></p>
<p>Let’s inspect the content of <code>data.files.fullpath</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data.files.fullpath</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d0.csv"</span></span>
<span><span class="co">## [2] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d1.csv"</span></span>
<span><span class="co">## [3] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d2.csv"</span></span>
<span><span class="co">## [4] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d3.csv"</span></span>
<span><span class="co">## [5] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d4.csv"</span></span></code></pre>
<p>You can see it contains a list of <em>absolute path</em> of multiple
CSV files, each belonging to a time-point.</p>
</div>
<div class="section level3">
<h3 id="dataset-as-fcs-files">Dataset as FCS files<a class="anchor" aria-label="anchor" href="#dataset-as-fcs-files"></a>
</h3>
<p>The procedure is very similar to reading CSV files above, except
we’re going to be storing FCS files’ path rather than CSV.</p>
<p>Again, here, we assume that each file contains data belonging to one
time-point. Hence you should have more than 1 FCS files. If this is not
the case, please reformat your data files.</p>
<p>To import the dataset stored as FCS files, TrackSOM needs to know
where the files are stored. These files’ location must be stored within
a vector which get passed on to the TrackSOM function.
<em>Important:</em> the vector must be organised such as the first
element is the data for the very first time-point, the 2nd element for
the 2nd time-point, and so on.</p>
<p>First, we start with specifying the FCS files are. In this example,
the dataset files are already stored within the package, so all you need
to do is load it up:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data.files.fullpath.fcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d0.fcs"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d1.fcs"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d2.fcs"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d3.fcs"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d4.fcs"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><em>For your dataset, please replace the content of the vector with
the <strong>absolute path</strong> for the dataset files!</em></p>
<p>Let’s inspect the content of
<code>data.files.fullpath.fcs</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data.files.fullpath.fcs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d0.fcs"</span></span>
<span><span class="co">## [2] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d1.fcs"</span></span>
<span><span class="co">## [3] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d2.fcs"</span></span>
<span><span class="co">## [4] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d3.fcs"</span></span>
<span><span class="co">## [5] "/home/runner/work/_temp/Library/TrackSOM/extdata/synthetic_d4.fcs"</span></span></code></pre>
<p>You can see it contains a list of <em>absolute path</em> of multiple
FCS files, each belonging to a time-point.</p>
</div>
<div class="section level3">
<h3 id="dataset-as-data-table-object">Dataset as <code>data.table</code> object<a class="anchor" aria-label="anchor" href="#dataset-as-data-table-object"></a>
</h3>
<p>Sometimes, it is convenient to have the dataset stored as the
<code>data.table</code> object files, e.g. when you need to run some
code to preprocess your data using R! As an example, supposed the
synthetic dataset CSV files were already read in as
<code>data.table</code> object prior to running TrackSOM (say you did
some preliminary clean up or filtering). What you need to do is organise
them in a list such that each element is a <code>data.table</code>
object for the dataset in a time-point. <em>Important:</em> the list
must be organised such as the first element is the data for the very
first time-point, the 2nd element for the 2nd time-point, and so on.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="va">data.files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d0.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d1.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d2.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d3.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d4.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data.files</span>, <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let’s do a quick preview of the data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##               x         y         z timepoint</span></span>
<span><span class="co">##           &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;char&gt;</span></span>
<span><span class="co">##    1:  9.598217 11.728198 11.382064      Mock</span></span>
<span><span class="co">##    2:  8.937549  8.653750 11.107314      Mock</span></span>
<span><span class="co">##    3:  9.632932  9.657278  9.115804      Mock</span></span>
<span><span class="co">##    4:  9.770393 12.478038 11.451082      Mock</span></span>
<span><span class="co">##    5: 30.426699 31.290929 28.901204      Mock</span></span>
<span><span class="co">##   ---                                        </span></span>
<span><span class="co">## 7096: 10.533174  9.462175  9.867354      Mock</span></span>
<span><span class="co">## 7097: 10.544833 10.426697  9.571881      Mock</span></span>
<span><span class="co">## 7098: 10.140938  8.727880 10.247086      Mock</span></span>
<span><span class="co">## 7099: 30.967131 30.261241 30.469085      Mock</span></span>
<span><span class="co">## 7100: 10.063984 10.289172 10.382876      Mock</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##               x         y         z timepoint</span></span>
<span><span class="co">##           &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;char&gt;</span></span>
<span><span class="co">##    1: 33.850857 30.653891 29.257884     SYN-1</span></span>
<span><span class="co">##    2: 10.429818 13.880273 10.878985     SYN-1</span></span>
<span><span class="co">##    3: 10.009247 10.327127 10.994237     SYN-1</span></span>
<span><span class="co">##    4:  9.751578  8.555277  8.914872     SYN-1</span></span>
<span><span class="co">##    5: 10.456213 10.972776 10.011441     SYN-1</span></span>
<span><span class="co">##   ---                                        </span></span>
<span><span class="co">## 7096:  9.237145 10.203747 12.475563     SYN-1</span></span>
<span><span class="co">## 7097: 12.957000  9.147637  8.807634     SYN-1</span></span>
<span><span class="co">## 7098: 12.297580 11.034141  9.828642     SYN-1</span></span>
<span><span class="co">## 7099:  9.393480 11.766797 11.137156     SYN-1</span></span>
<span><span class="co">## 7100: 11.684874  8.864774 11.771160     SYN-1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">##               x         y         z timepoint</span></span>
<span><span class="co">##           &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;char&gt;</span></span>
<span><span class="co">##    1: 10.107081 10.371958  8.862552     SYN-2</span></span>
<span><span class="co">##    2: 12.271113 28.710774 13.945666     SYN-2</span></span>
<span><span class="co">##    3: 10.248482 10.249500  7.918076     SYN-2</span></span>
<span><span class="co">##    4:  9.341533 10.228882 12.209994     SYN-2</span></span>
<span><span class="co">##    5: 10.116334  9.805188  9.742291     SYN-2</span></span>
<span><span class="co">##   ---                                        </span></span>
<span><span class="co">## 7196: 10.682697 13.643521 10.637965     SYN-2</span></span>
<span><span class="co">## 7197: 27.598520 30.275747 29.691414     SYN-2</span></span>
<span><span class="co">## 7198: 10.728449 10.020652  9.517445     SYN-2</span></span>
<span><span class="co">## 7199: 10.167862  9.754739  9.416342     SYN-2</span></span>
<span><span class="co">## 7200:  9.554067 11.296156 12.535182     SYN-2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[4]]</span></span>
<span><span class="co">##               x         y         z timepoint</span></span>
<span><span class="co">##           &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;char&gt;</span></span>
<span><span class="co">##    1: 13.864150  8.884197  8.742413     SYN-3</span></span>
<span><span class="co">##    2: 25.420014 40.961726 26.453685     SYN-3</span></span>
<span><span class="co">##    3: 23.968729 31.313815 31.314857     SYN-3</span></span>
<span><span class="co">##    4: 10.538730  9.855319  9.061674     SYN-3</span></span>
<span><span class="co">##    5:  8.814686 12.068781 10.729973     SYN-3</span></span>
<span><span class="co">##   ---                                        </span></span>
<span><span class="co">## 7196: 10.358157  8.856995 10.440222     SYN-3</span></span>
<span><span class="co">## 7197: 10.093926 11.400187 10.429873     SYN-3</span></span>
<span><span class="co">## 7198: 14.720125 10.599644  9.599185     SYN-3</span></span>
<span><span class="co">## 7199: 24.545254 29.734070 29.035897     SYN-3</span></span>
<span><span class="co">## 7200:  9.967504 14.351193 11.619231     SYN-3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[5]]</span></span>
<span><span class="co">##               x         y         z timepoint</span></span>
<span><span class="co">##           &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;char&gt;</span></span>
<span><span class="co">##    1: 10.088854 10.171541 10.122280     SYN-4</span></span>
<span><span class="co">##    2: 14.776449 10.189092 10.621575     SYN-4</span></span>
<span><span class="co">##    3:  9.652116 12.567544  9.282672     SYN-4</span></span>
<span><span class="co">##    4: 10.436809 10.725664 10.016877     SYN-4</span></span>
<span><span class="co">##    5: 10.235657 10.966951  9.371363     SYN-4</span></span>
<span><span class="co">##   ---                                        </span></span>
<span><span class="co">## 7096: 21.234807 30.522073 30.590687     SYN-4</span></span>
<span><span class="co">## 7097:  9.703690  8.319128  9.579323     SYN-4</span></span>
<span><span class="co">## 7098: 17.654003 30.891041 29.390515     SYN-4</span></span>
<span><span class="co">## 7099:  9.089960  9.744563 12.483508     SYN-4</span></span>
<span><span class="co">## 7100: 36.910728 29.551236 29.926378     SYN-4</span></span></code></pre>
<p>As you can see, there are 5 elements in the list, each containing a
dataset belonging to a time-point.</p>
</div>
</div>
<div class="section level2">
<h2 id="running-tracksom">Running TrackSOM<a class="anchor" aria-label="anchor" href="#running-tracksom"></a>
</h2>
<p>Depending on how your dataset is stored, the parameter
<code>inputFiles</code> is either a vector of absolute path of your CSV
or FCS files or a list of <code>data.table</code> object. Additionally,
you need to specify the type as the parameter <code>dataFileType</code>.
It can be either <code>.csv</code>, <code>.fcs</code>, or
<code>data.frame</code> depending on how your dataset is stored.</p>
<div class="section level3">
<h3 id="other-parameters">Other parameters<a class="anchor" aria-label="anchor" href="#other-parameters"></a>
</h3>
<p><strong><em>Note:</em></strong> examples here assume datasets are
stored as CSV files.</p>
<p>The TrackSOM function have various parameters. Of them, only
<code>inputFiles</code> and <code>colsToUse</code> have no default
values. The <code>inputFiles</code> parameter has been explained in the
previous section.</p>
<p>The <code>colsToUse</code> parameter specify the columns in your
dataset to be used for clustering and tracking. This must be a vector.
For the synthetic dataset, the columns are denoted as <code>x</code>,
<code>y</code>, and <code>z</code>. For cytometry data, this should be a
vector of markers.</p>
<p>The TrackSOM functions have the following parameters which are
pre-filled with default values:</p>
<ul>
<li>tracking: TRUE (default) or FALSE, whether to perform tracking.</li>
<li>noMerge: TRUE or FALSE (default), whether to allow merging of
meta-clusters (FALSE) or not (TRUE). If noMerge is set to TRUE,
meta-clusters are only allowed to split, but not merge.</li>
<li>maxMeta: NULL (default) or round number. Maximum number of meta
clusters for all time point. Only used for Autonomous Adaptive
operation.</li>
<li>nClus: NULL (default) or numeric or a vector of numbers. If single
number, TrackSOM will run Prescribed Invariant operation. Otherwise, it
will run Prescribed Variant operation.</li>
<li>seed: 42 (default). Random seed number.</li>
<li>xdim: 10 (default). SOM grid size.</li>
<li>ydim: 10 (default). SOM grid size.</li>
</ul>
<p>The function also accept parameters that are built into <a href="https://bioconductor.org/packages/release/bioc/html/FlowSOM.html" class="external-link">FlowSOM</a>
<code>ReadInput</code>, <code>BuildSOM</code> and <code>BuildMST</code>
functions. See FlowSOM’s vignette for specific parameter
information.</p>
<p>Let’s run TrackSOM with the following settings:</p>
<ul>
<li>No merging of meta-clusters allowed
(<code>noMerge = TRUE</code>)</li>
<li>Enable tracking (<code>tracking = TRUE</code>)</li>
<li>Prescribed Variant producing 3, 3, 9, 7, 15 meta-clusters for each
time-point.</li>
</ul>
<p>The remaining parameters will be set to the default values.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracksom.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TrackSOM.html">TrackSOM</a></span><span class="op">(</span>inputFiles <span class="op">=</span> <span class="va">data.files.fullpath</span>,</span>
<span>                            colsToUse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'z'</span><span class="op">)</span>,</span>
<span>                            tracking <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            noMerge <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            nClus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">7</span>,<span class="fl">15</span><span class="op">)</span>,</span>
<span>                            dataFileType <span class="op">=</span> <span class="st">".csv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Building SOM</span></span></code></pre>
<pre><code><span><span class="co">## Mapping data to SOM</span></span></code></pre>
<pre><code><span><span class="co">## Building MST</span></span></code></pre>
<pre><code><span><span class="co">## Extracting SOM nodes for each time point</span></span></code></pre>
<pre><code><span><span class="co">## Running meta clustering</span></span></code></pre>
<pre><code><span><span class="co">## Meta clustering time point 1 with 82 SOM nodes</span></span></code></pre>
<pre><code><span><span class="co">## Meta clustering time point 2 with 93 SOM nodes</span></span></code></pre>
<pre><code><span><span class="co">## Meta clustering time point 3 with 90 SOM nodes</span></span></code></pre>
<pre><code><span><span class="co">## Meta clustering time point 4 with 95 SOM nodes</span></span></code></pre>
<pre><code><span><span class="co">## Meta clustering time point 5 with 95 SOM nodes</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="extracting-meta-clusters-id-and-som-nodes">Extracting meta-clusters ID and SOM nodes<a class="anchor" aria-label="anchor" href="#extracting-meta-clusters-id-and-som-nodes"></a>
</h2>
<p>TrackSOM result is stored in an object. To facilitate the extraction
of meta-clusters ID and SOM nodes for each cell, we provide the
following functions:</p>
<ul>
<li>
<code>ConcatenateClusteringDetails</code>: assuming your dataset is
stored as a <code>data.table</code> object, the function attaches the
meta-cluster ID and SOM nodes as separate columns.</li>
<li>
<code>ExportClusteringDetailsOnly</code>: this function simply
extract the meta-cluster ID and SOM nodes for each cell as a
<code>data.table</code> object. The cells are ordered based on the
ordering of your dataset.</li>
</ul>
<p>To use <code>ConcatenateClusteringDetails</code>, you need to first
read in all your datasets as one giant <code>data.table</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="va">data.files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d0.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d1.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d2.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d3.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"synthetic_d4.csv"</span>, package <span class="op">=</span> <span class="st">"TrackSOM"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data.files</span>, <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<p>Double check the data is read in properly:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            x         y         z timepoint</span></span>
<span><span class="co">##        &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;char&gt;</span></span>
<span><span class="co">## 1:  9.598217 11.728198 11.382064      Mock</span></span>
<span><span class="co">## 2:  8.937549  8.653750 11.107314      Mock</span></span>
<span><span class="co">## 3:  9.632932  9.657278  9.115804      Mock</span></span>
<span><span class="co">## 4:  9.770393 12.478038 11.451082      Mock</span></span>
<span><span class="co">## 5: 30.426699 31.290929 28.901204      Mock</span></span>
<span><span class="co">## 6: 30.789497 30.069909 30.767145      Mock</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            x         y         z timepoint</span></span>
<span><span class="co">##        &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;char&gt;</span></span>
<span><span class="co">## 1:  7.954781  9.241713  9.429919     SYN-4</span></span>
<span><span class="co">## 2: 21.234807 30.522073 30.590687     SYN-4</span></span>
<span><span class="co">## 3:  9.703690  8.319128  9.579323     SYN-4</span></span>
<span><span class="co">## 4: 17.654003 30.891041 29.390515     SYN-4</span></span>
<span><span class="co">## 5:  9.089960  9.744563 12.483508     SYN-4</span></span>
<span><span class="co">## 6: 36.910728 29.551236 29.926378     SYN-4</span></span></code></pre>
<p>To run <code>ConcatenateClusteringDetails</code>, you need to pass
the following parameters:</p>
<ul>
<li>
<code>timepoint.col</code>: which column in your data define the
time-point.</li>
<li>
<code>timepoints</code>: what are the time-points (in order). This
must be a vector.</li>
</ul>
<p>Now let’s attach the meta-cluster ID and the SOM nodes:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat.clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ConcatenateClusteringDetails.html">ConcatenateClusteringDetails</a></span><span class="op">(</span></span>
<span>    tracksom.result <span class="op">=</span> <span class="va">tracksom.result</span>,</span>
<span>    dat <span class="op">=</span> <span class="va">dat</span>,</span>
<span>    timepoint.col <span class="op">=</span> <span class="st">"timepoint"</span>,</span>
<span>    timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Mock'</span>, <span class="st">'SYN-1'</span>, <span class="st">'SYN-2'</span>, <span class="st">'SYN-3'</span>, <span class="st">'SYN-4'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Inspect the content:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat.clust</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            x         y         z timepoint TrackSOM_cluster</span></span>
<span><span class="co">##        &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;char&gt;            &lt;num&gt;</span></span>
<span><span class="co">## 1:  9.598217 11.728198 11.382064      Mock               62</span></span>
<span><span class="co">## 2:  8.937549  8.653750 11.107314      Mock               53</span></span>
<span><span class="co">## 3:  9.632932  9.657278  9.115804      Mock               86</span></span>
<span><span class="co">## 4:  9.770393 12.478038 11.451082      Mock               61</span></span>
<span><span class="co">## 5: 30.426699 31.290929 28.901204      Mock               16</span></span>
<span><span class="co">## 6: 30.789497 30.069909 30.767145      Mock                6</span></span>
<span><span class="co">##    TrackSOM_metacluster TrackSOM_metacluster_lineage_tracking</span></span>
<span><span class="co">##                  &lt;fctr&gt;                                &lt;fctr&gt;</span></span>
<span><span class="co">## 1:                    2                                     B</span></span>
<span><span class="co">## 2:                    2                                     B</span></span>
<span><span class="co">## 3:                    2                                     B</span></span>
<span><span class="co">## 4:                    2                                     B</span></span>
<span><span class="co">## 5:                    1                                     A</span></span>
<span><span class="co">## 6:                    1                                     A</span></span></code></pre>
<p>The function attaches extra 3 columns:</p>
<ul>
<li>
<code>TrackSOM_cluster</code>: The SOM node of each cell.</li>
<li>
<code>TrackSOM_metacluster</code>: The meta-cluster assignment
produced by FlowSOM’s meta-clustering.</li>
<li>
<code>TrackSOM_metacluster_lineage_tracking</code>: The tracking of
meta-clusters’ evolution produced by TrackSOM. <strong>This gives you
the changes undergone by the meta-clusters over time</strong>.</li>
</ul>
<p>The function gives back a <code>data.table</code> object which you
can export as CSV file using <code>data.table</code>’s
<code>fwrite</code> function.</p>
</div>
<div class="section level2">
<h2 id="visualisations">Visualisations<a class="anchor" aria-label="anchor" href="#visualisations"></a>
</h2>
<p>TrackSOM offers 2 visualisation mediums:</p>
<ol style="list-style-type: decimal">
<li>Network plot.</li>
<li>Timeseries heatmap.</li>
</ol>
<div class="section level3">
<h3 id="network-plot">Network plot<a class="anchor" aria-label="anchor" href="#network-plot"></a>
</h3>
<p>To draw network plots, we need to call the
<code>DrawNetworkPlot</code> function. Using the clustered and tracked
data from previous sections, the following is an example on how to use
the function:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DrawNetworkPlot.html">DrawNetworkPlot</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat.clust</span>,</span>
<span>                timepoint.col <span class="op">=</span> <span class="st">"timepoint"</span>,</span>
<span>                timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Mock'</span>, <span class="st">'SYN-1'</span>, <span class="st">'SYN-2'</span>, <span class="st">'SYN-3'</span>, <span class="st">'SYN-4'</span><span class="op">)</span>,</span>
<span>                cluster.col <span class="op">=</span> <span class="st">'TrackSOM_metacluster_lineage_tracking'</span>,</span>
<span>                marker.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'z'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating edges</span></span></code></pre>
<pre><code><span><span class="co">## Computing node details</span></span></code></pre>
<pre><code><span><span class="co">## Calculating marker's average per node</span></span></code></pre>
<pre><code><span><span class="co">## Saving node and edge details</span></span></code></pre>
<pre><code><span><span class="co">## Start drawing plots</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Existing variables `x` and `y` overwritten by layout variables</span></span></code></pre>
<pre><code><span><span class="co">## Drawing plots coloured by time point</span></span></code></pre>
<pre><code><span><span class="co">## Drawing plots coloured by origin</span></span></code></pre>
<pre><code><span><span class="co">## Drawing plots coloured by x</span></span></code></pre>
<pre><code><span><span class="co">## Drawing plots coloured by y</span></span></code></pre>
<pre><code><span><span class="co">## Drawing plots coloured by z</span></span></code></pre>
<p>The <code>marker.cols</code> will determine the <em>markers</em>
which mean/median expression will be drawn on the network plots. There
is no need to specify all the markers in the dataset, just the ones that
you want the network plots to be coloured on.</p>
<p>The function won’t preview any plots, but it will instead store the
plots as image files and some extra information (median/mean expression
of markers) as CSV files:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "network_colBy_origin.pdf"      "network_colBy_timepoints.pdf" </span></span>
<span><span class="co">## [3] "network_colBy_x.pdf"           "network_colBy_y.pdf"          </span></span>
<span><span class="co">## [5] "network_colBy_z.pdf"           "network_plot_edge_details.csv"</span></span>
<span><span class="co">## [7] "network_plot_node_details.csv" "TrackSOM-workflow.Rmd"</span></span></code></pre>
<p>In this example, the plots are saved as PDF files. This can be
changed, e.g. to save the plots as PNG files, by specifying the desired
file format as the <code>file.format</code> parameter.</p>
</div>
<div class="section level3">
<h3 id="timeseries-heatmap">Timeseries heatmap<a class="anchor" aria-label="anchor" href="#timeseries-heatmap"></a>
</h3>
<p>To draw a timeseries heatmap, we need to call the
<code>DrawTimeseriesHeatmap</code> function. Using the clustered and
tracked data from previous sections, the following is an example on how
to use the function:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DrawTimeseriesHeatmap.html">DrawTimeseriesHeatmap</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat.clust</span>,</span>
<span>                timepoint.col <span class="op">=</span> <span class="st">"timepoint"</span>,</span>
<span>                timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Mock'</span>, <span class="st">'SYN-1'</span>, <span class="st">'SYN-2'</span>, <span class="st">'SYN-3'</span>, <span class="st">'SYN-4'</span><span class="op">)</span>,</span>
<span>                cluster.col <span class="op">=</span> <span class="st">'TrackSOM_metacluster_lineage_tracking'</span>,</span>
<span>                marker.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'z'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Computing node details</span></span></code></pre>
<pre><code><span><span class="co">## Computing edge details</span></span></code></pre>
<pre><code><span><span class="co">## Saving node and edge details</span></span></code></pre>
<pre><code><span><span class="co">## Drawing timeseries heatmap coloured by x</span></span></code></pre>
<pre><code><span><span class="co">## Drawing timeseries heatmap coloured by y</span></span></code></pre>
<pre><code><span><span class="co">## Drawing timeseries heatmap coloured by z</span></span></code></pre>
<p>The <code>marker.cols</code> will determine the <em>markers</em>
which mean/median expression will be drawn on the network plots. There
is no need to specify all the markers in the dataset, just the ones that
you want the network plots to be coloured on.</p>
<p>The function won’t preview any plots, but it will instead store the
plots as image files and some extra information (median/mean expression
of markers) as CSV files:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "network_colBy_origin.pdf"            </span></span>
<span><span class="co">##  [2] "network_colBy_timepoints.pdf"        </span></span>
<span><span class="co">##  [3] "network_colBy_x.pdf"                 </span></span>
<span><span class="co">##  [4] "network_colBy_y.pdf"                 </span></span>
<span><span class="co">##  [5] "network_colBy_z.pdf"                 </span></span>
<span><span class="co">##  [6] "network_plot_edge_details.csv"       </span></span>
<span><span class="co">##  [7] "network_plot_node_details.csv"       </span></span>
<span><span class="co">##  [8] "Timeseries_heatmap_by_x.pdf"         </span></span>
<span><span class="co">##  [9] "Timeseries_heatmap_by_y.pdf"         </span></span>
<span><span class="co">## [10] "Timeseries_heatmap_by_z.pdf"         </span></span>
<span><span class="co">## [11] "timeseries_heatmap_edges_details.csv"</span></span>
<span><span class="co">## [12] "timeseries_heatmap_node_details.csv" </span></span>
<span><span class="co">## [13] "TrackSOM-workflow.Rmd"</span></span></code></pre>
<p>In this example, the plots are saved as PDF files. This can be
changed, e.g. to save the plots as PNG files, by specifying the desired
file format as the <code>file.format</code> parameter.</p>
</div>
</div>
<div class="section level2">
<h2 id="concluding-remarks">Concluding remarks<a class="anchor" aria-label="anchor" href="#concluding-remarks"></a>
</h2>
<p>That is pretty much it folks! We’re actively updating TrackSOM and
welcome feedbacks!</p>
<p>Thank you for your interest!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Givanna Putri, Davis Edwards, Mark Read.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
